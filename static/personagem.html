<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="UTF-8">
  <title>Personagem</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
<header>Personagem</header>
<nav>
    <a href="index.html">Menu</a>
    <a href="ficha.html">Ficha</a>
    <a href="historia.html">História</a>
    <a href="mensagens.html">Mensagens</a>
</nav>
<div class="container">
  <div class="card" style="max-width:500px; margin:auto;">
    <h3>Sua Ficha</h3>
    <div id="sheet">
      <p>Carregando ficha...</p>
    </div>
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", async () => {
  const username = localStorage.getItem("username");
  if (!username) {
    window.location.href = "login.html";
    return;
  }

  const sheetDiv = document.getElementById("sheet");
  try {
    const res = await fetch("/get_sheet/" + username);
    const data = await res.json();
    if (!data || Object.keys(data).length === 0) {
      sheetDiv.innerHTML = "<p>Você ainda não criou sua ficha. Preencha em <a href='ficha.html'>Ficha</a>.</p>";
      return;
    }

    sheetDiv.innerHTML = `
    <p><strong>Nome:</strong> ${data.nome || "-"}</p>
    <p><strong>Classe:</strong> ${data.classe || "-"}</p>
    <p><strong>Raça:</strong> ${data.raca || "-"}</p>
    <p><strong>Nível:</strong> ${data.nivel || 0}</p>
    <p><strong>Força:</strong> ${data.forca || 0}</p>
    <p><strong>Velocidade:</strong> ${data.velocidade || 0}</p>
    <p><strong>Inteligência:</strong> ${data.inteligencia || 0}</p>
    <p><strong>Mana:</strong> ${data.mana || 0}</p>
    <p><strong>Descrição:</strong> ${data.descricao || "-"}</p>
    `;

  } catch(err) {
    console.error(err);
    sheetDiv.innerHTML = "<p>Erro ao carregar ficha.</p>";
  }
});
</script>
</body>
</html>

